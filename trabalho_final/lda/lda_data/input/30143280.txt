ios hkobserverquery background update completionhandler following method supports receiving updates background following looking post confusion revolving handler questions handler called called late think app received query update causing hit background update strikes back algorithm documentation state called handling query depending long take run query sounds dangerously close hitting background update strikes needed shouldn system know app launched received background update background wakes app background second call handler deal background update strikes hit background update strikes stops sending update permanent start sending background update bug prevented handler called fixed app stuck receiving update reset app launched updated keep app running background handler called part purpose side effect part purpose long run needing stop hit 1st background update strike