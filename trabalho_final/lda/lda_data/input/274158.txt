ushort string conversion possible painful library moment accepting string way arrays data apparently makes marshalling pinvoke easier make ushort array string byte tried way doesn finish remotely close sane amount time unsafe intptr intermediate char significantly easier edit function call value length dicom type function generated wrapper library swig representation chosen string cross managed unmanaged boundary relatively easily code project gdcm char simply byte buffer set image buffer pointer fairly simple stuck weird problem hackeration know probably best thing make swig library work right don know quick workaround side exists