create categorical field data frame based values data frame create categorical variable based value data frame consider table hospital visits patient ids note patient visit hospital add new field indicating patient received aspirin hospital visit table multiple level receive medicine doctor right example course tried merge table inner join worked ended duplicate patient got aspirin ibuprofen know got aspirin least shape table new index