logic option argument custom hl7 pars function wrote custom function pars hl7 interfac messag messag healthcar inform system basic long text string delimit variou charact indic differ field past cell excel function creat search count find field specifi argument disclaim new vba teach onlin research trial error past week vba expert prefer arrai tri code got complex troubleshoot code easi follow oppos fastest effici got work pretti stuck logic option argument work formula note argument result result note know told stop instanc hl7 subfield delimit formula note option 4th argument result formula note option 4th argument result content valu cell vba code sorri comment learn problem split function put arrai need search 1st kwsegmentstringtosearchfor msh pv1 cout pipe charact arrai separ nest arrai got wai confus abandon split function initi plan arrai wrote find thing sequenti search kwsegmentstringtosearchfor msh pv1 instr count pipe charact determin number field return string variabl length delimit special charact determin charact return mid function search delimit field found start point call end field issu logic consid possibl delimit end field take code wouldn know end string add sort statement option 4th argument exist sure ignor delimit return full field adt wouldn return sub field compon thank