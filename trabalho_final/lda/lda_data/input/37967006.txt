statistics month hkquantitytype cumulative aggregation style create statistics month hkquantitytype cumulative aggregation style health app view hkstatisticscollectionquery calculate sum cumulative type works making hksamplequery quest predicate start end dates month iterating query result calculate number samples contain sample number ready divide sum moths number main problem samples moth got samples number month sample metric running background thread amount memory calculating average month takes minute calculate possibility number samples month groped didn found solution