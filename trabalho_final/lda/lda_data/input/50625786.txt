peekmessage translatemessage dispatchmessage way natively extern working upgrading older project uses mecahnism dicom service leadtool example code require extenn user32 dll trying figure newer better way accomplish idea