wrote custom function parses interface message messages healthcare information systems basically long text string delimited various characters indicate different fields paste cell excel function created searches counts find fields specified arguments disclaimer new vba teaching online research trial error past weeks vba expert prefer arrays tried code got complex troubleshoot code easy follow opposed fastest efficient got working pretty stuck adding logic optional argument work formula note arguments result result note know told stop instance subfield delimiter formula note optional argument result formula note optional argument result contents value cell vba code sorry comments learning problem split function put arrays needed search kwsegmentstringtosearchfor msh couting pipe characters array separate nested arrays got way confusing abandoned split function initial plans arrays wrote find things sequentially searches kwsegmentstringtosearchfor msh instr counts pipe characters determine number field return strings variable length delimited special characters determine characters return mid function search delimiter field found starting point call end field issue logic considers possible delimiters end field take code wouldn know end string add sort statement optional argument exists sure ignore delimiter return full field adt wouldn return sub field component thanks
