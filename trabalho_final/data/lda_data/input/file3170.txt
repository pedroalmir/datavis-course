hkobserverquery background delivery ios application updatehandler hkobserverquery execute query hkanchoredobjectquery send results remote server https slow connection edge example big amount data steps example data sending take minute documentation hkobserverquerycompletionhandler healthkit wakes app calls update handler observer queries match new data block passed update handler call block soon done processing incoming data calling block tells healthkit successfully received background data call block healthkit continues attempt launch app back algorithm app fails respond three times healthkit assumes app receive data stops sending background updates question time call hkobserverquerycompletionhandler app assumed healthkit hanged call hkobserverquerycompletionhandler immediately run new long running background task https request
